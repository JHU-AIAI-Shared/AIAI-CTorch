# **CTorch: PyTorch-Compatible GPU-Accelerated Auto-Differentiable Toolbox for Computed Tomography**

<table align="center">
  <tr>
    <td align="center">
        <img src="framework.png" alt="framework" width="500"><br>
        <strong>CTorch framework<strong>
    </td>
    <td align="center">
        <img src="noncircular.gif" alt="noncircular" width="400"><br>
        <strong>Projection generated by CTorch<strong>
    </td>
  </tr>
</table>

## ðŸ˜Ž This is a PyTorch-compatible, GPU-accelerated, and auto-differentiable toolbox for Computed Tomography Imaging
   

# [Features](#key-features) â€¢ [Supported Platform](#supported-platforms-and-cuda-versions) â€¢ [Request Access](#request-access) â€¢ [Authors](#authors) â€¢ [References](#references)

## Key Features
 - **Flexible Geometry Definition**: Supports 2D fan-beam, 3D circular cone-beam, and 3D non-circular cone-beam geometries. Additionally, each geometry allows view-specific definitions to handle variations during scanning.
 - **GPU-Accelerated Auto-Differentiable Forward/Back Projectors**: Directly accept variables as PyTorch tensors, enabling seamless integration into any PyTorch-based algorithm.
 - **Multiple Projection Algorithms**: Implements four projector algorithmsâ€”voxel-driven, ray-driven, distance-driven (DD), and separable footprint (SF)â€”allowing users to select the most suitable method for their specific application.
 - **Curved Detector Support**: Enables projection for 2D fan-beam and 3D circular cone-beam geometries, enhancing compatibility with clinical CT data.
 - **Optimized Data Layout**: Follows PyTorch batched and channeled data format, facilitating efficient parallel processing of multiple samples and ensuring smooth integration with PyTorch-based pipelines.

## Supported Platforms and CUDA Versions
| Supported Platforms | CUDA Version | Precompiled Files |
|----------------------|--------------|-------------------|
| Linux / Windows      | CUDA 11.x    | `.so`, `.dll`, `.lib` |
| Linux / Windows      | CUDA 12.x    | `.so`, `.dll`, `.lib` |


## Request Access
 Please read the LICENSE file. If you agree to the terms, email Prof. Web Stayman ([(web.stayman@jhu.edu)](web.stayman@jhu.edu)), cc'ing Xiao Jiang ([(xjiang43@jhu.edu)](xjiang43@jhu.edu)) with your GitHub username to request access.

## Authors

- Xiao Jiang [(xjiang43@jhu.edu)](xjiang43@jhu.edu), J. Webster Stayman[(web.stayman@jhu.edu)](web.stayman@jhu.edu)

  The Advanced Imaging Algorithms and Instrumentation Laboratory

  Department of Biomedical Engineering, Johns Hopkins University

- Grace J. Gang [(grace.j.gang@pennmedicine.upenn.edu)](grace.j.gang@pennmedicine.upenn.edu)

  Laboratory for Imaging Physics, Analysis, and Clinical Translation

  Department of Radiology, University of Pennsylvania

## References

 - If you use CTorch, please cite the following paper:

   Jiang, X., Gang, G., & Stayman, J. W. (2025). CTorch: PyTorch-Compatible GPU-Accelerated Auto-Differentiable Projector Toolbox for Computed Tomography. ArXiv, https://arxiv.org/abs/2503.16741
   
 - If you use diffusion examples (and our pre-trained diffusion weights), please cite the following paper:

   Jiang, X., Li, S., Teng, P., Gang, G., & Stayman, J. W. (2024). Strategies for CT Reconstruction using Diffusion Posterior Sampling with a Nonlinear Model. ArXiv, https://arxiv.org/abs/2407.12956.

   Li, S., Jiang, X., Tivnan, M., Gang, G. J., Shen, Y., & Stayman, J. W. (2024). CT reconstruction using diffusion posterior sampling conditioned on a nonlinear measurement model. Journal of Medical Imaging, 11(4), 043504-043504.

